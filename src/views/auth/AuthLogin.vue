<template>
  <div class="flex justify-center items-center flex-col">
    <div class="smart">
      <img :src="smart" alt="smart tizim"/>
    </div>
    <Form @submit="submit" class="auth__form">
      <div class="auth__form-item">
        <Field
            :rules="rules.username"
            :modelValue="phoneNumber"
            v-slot="{ errors }"
            name="Phone Number"
        >
          <div class="prepend">
            <svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
              <path
                  d="m512 256c0 68.378906-26.628906 132.671875-74.980469 181.019531-48.328125 48.332031-112.578125 74.960938-180.929687 74.980469h-.089844c-68.378906 0-132.671875-26.628906-181.019531-74.980469-48.351563-48.347656-74.980469-112.640625-74.980469-181.019531s26.628906-132.671875 74.980469-181.019531c48.347656-48.351563 112.640625-74.980469 181.019531-74.980469h.089844c68.351562.0195312 132.601562 26.648438 180.929687 74.980469 48.351563 48.347656 74.980469 112.640625 74.980469 181.019531zm0 0"
                  fill="#0cf"></path>
              <path
                  d="m512 256c0 68.378906-26.628906 132.671875-74.980469 181.019531-48.328125 48.332031-112.578125 74.960938-180.929687 74.980469v-512c68.351562.0195312 132.601562 26.648438 180.929687 74.980469 48.351563 48.347656 74.980469 112.640625 74.980469 181.019531zm0 0"
                  fill="#00a8e8"></path>
              <path
                  d="m349.410156 380.808594c-18.070312 19.511718-54.621094 13.480468-93.320312-7.75-56.988282-31.257813-118.621094-95.480469-132.691406-159.636719-8.308594-37.851563 4.652343-44.871094 26.730468-67.210937 17.632813-17.839844 22.460938-23.921876 34.800782-23.921876 10.082031 0 18.332031 5.832032 23.429687 14.621094 29.8125 56.621094 43.839844 66.449219 13.53125 94.011719 5.230469 12.277344 19.578125 28.957031 34.199219 42.066406 9.289062 8.339844 18.691406 15.25 25.898437 18.671875 2.0625-2.109375 5.261719-5.390625 10.082031-10.300781 20.417969-19.4375 42.339844-1.28125 54.890626 6.152344 28.617187 16.929687 41.140624 20.929687 43.828124 37.25 2.132813 16.378906-4.898437 19.816406-41.378906 56.046875zm0 0"
                  fill="#fff"></path>
              <path
                  d="m349.410156 380.808594c-18.070312 19.511718-54.621094 13.480468-93.320312-7.75v-100.070313c9.289062 8.339844 18.691406 15.25 25.898437 18.671875 2.0625-2.109375 5.261719-5.390625 10.082031-10.300781 20.417969-19.4375 42.339844-1.28125 54.890626 6.152344 28.617187 16.929687 41.140624 20.929687 43.828124 37.25 2.132813 16.378906-4.898437 19.816406-41.378906 56.046875zm0 0"
                  fill="#d7f3ff"></path>
            </svg>
          </div>
          <input
              v-mask="'(+998)-##-###-##-##'"
              masked="true"
              class="auth__form-input"
              type="text"
              placeholder="(+998)-93-102-06-36"
              v-model="phoneNumber"
          />
          <p class="auth__form-error" v-if="errors && errors.length">
            {{ errors[0] }}
          </p>
        </Field>
      </div>
      <div class="auth__form-item">
        <Field
            :rules="rules.password"
            :modelValue="loginModel.password"
            v-slot="{ errors }"
            name="password"
        >
          <div class="prepend">
            <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M6.41667 6.41536C6.41667 3.88406 8.4687 1.83203 11 1.83203C13.5313 1.83203 15.5833 3.88406 15.5833 6.41536V9.16536H16.5C18.0188 9.16536 19.25 10.3966 19.25 11.9154V17.4154C19.25 18.9341 18.0188 20.1654 16.5 20.1654H5.5C3.98122 20.1654 2.75 18.9341 2.75 17.4154V11.9154C2.75 10.3966 3.98122 9.16536 5.5 9.16536H6.41667V6.41536ZM8.25 9.16536H13.75V6.41536C13.75 4.89658 12.5188 3.66536 11 3.66536C9.48122 3.66536 8.25 4.89658 8.25 6.41536V9.16536ZM5.5 10.9987C4.99374 10.9987 4.58333 11.4091 4.58333 11.9154V17.4154C4.58333 17.9216 4.99374 18.332 5.5 18.332H16.5C17.0063 18.332 17.4167 17.9216 17.4167 17.4154V11.9154C17.4167 11.4091 17.0063 10.9987 16.5 10.9987H5.5ZM11 12.832C11.5063 12.832 11.9167 13.2424 11.9167 13.7487V15.582C11.9167 16.0883 11.5063 16.4987 11 16.4987C10.4937 16.4987 10.0833 16.0883 10.0833 15.582V13.7487C10.0833 13.2424 10.4937 12.832 11 12.832Z"
                    fill="#1d2d5b"/>
            </svg>
          </div>

          <div class="append">
            <svg @click="togglePasswordEye(true)" v-if="passwordHideShow" style="cursor: pointer ;" width="22"
                 height="22"
                 viewBox="0 0 20 20"
                 fill="none"
                 xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M2.92653 9.99867C3.95629 12.9125 6.73556 14.9987 10 14.9987C13.2645 14.9987 16.0437 12.9125 17.0735 9.99872C16.0437 7.08491 13.2645 4.9987 10 4.9987C6.73556 4.9987 3.95631 7.08488 2.92653 9.99867ZM1.25314 9.74896C2.42098 6.03071 5.89425 3.33203 10 3.33203C14.1058 3.33203 17.5791 6.03075 18.7469 9.74902C18.7979 9.91158 18.7979 10.0859 18.7469 10.2484C17.579 13.9667 14.1058 16.6654 10 16.6654C5.89424 16.6654 2.42096 13.9667 1.25314 10.2484C1.20208 10.0858 1.20208 9.91152 1.25314 9.74896ZM9.99963 8.33203C9.07916 8.33203 8.33297 9.07822 8.33297 9.9987C8.33297 10.9192 9.07916 11.6654 9.99963 11.6654C10.9201 11.6654 11.6663 10.9192 11.6663 9.9987C11.6663 9.07822 10.9201 8.33203 9.99963 8.33203ZM6.6663 9.9987C6.6663 8.15775 8.15869 6.66536 9.99963 6.66536C11.8406 6.66536 13.333 8.15775 13.333 9.9987C13.333 11.8396 11.8406 13.332 9.99963 13.332C8.15869 13.332 6.6663 11.8396 6.6663 9.9987Z"
                    fill="#1d2d5b"/>
            </svg>
            <svg v-else @click="togglePasswordEye(false)" style="cursor: pointer ;" width="22" height="22"
                 viewBox="0 0 22 22"
                 fill="none"
                 xmlns="http://www.w3.org/2000/svg">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M3.21928 11.0013C4.35202 14.2065 7.40921 16.5013 11.0001 16.5013C14.591 16.5013 17.6482 14.2065 18.7809 11.0013C17.6482 7.79613 14.591 5.5013 11.0001 5.5013C7.40921 5.5013 4.35203 7.7961 3.21928 11.0013ZM1.37855 10.7266C2.66318 6.63652 6.48377 3.66797 11.0001 3.66797C15.5164 3.66797 19.3371 6.63656 20.6217 10.7267C20.6778 10.9055 20.6778 11.0972 20.6217 11.276C19.337 15.3661 15.5164 18.3346 11.0001 18.3346C6.48376 18.3346 2.66316 15.3661 1.37855 11.2759C1.32238 11.0971 1.32239 10.9054 1.37855 10.7266ZM10.9997 9.16797C9.98717 9.16797 9.16636 9.98878 9.16636 11.0013C9.16636 12.0138 9.98717 12.8346 10.9997 12.8346C12.0122 12.8346 12.833 12.0138 12.833 11.0013C12.833 9.98878 12.0122 9.16797 10.9997 9.16797ZM7.33303 11.0013C7.33303 8.97626 8.97465 7.33464 10.9997 7.33464C13.0247 7.33464 14.6664 8.97626 14.6664 11.0013C14.6664 13.0263 13.0247 14.668 10.9997 14.668C8.97465 14.668 7.33303 13.0263 7.33303 11.0013Z"
                    fill="#1d2d5b"/>
              <line x1="1.53711" y1="18.4099" x2="20.4533" y2="3.57156"
                    stroke="#1d2d5b" stroke-width="1.5"/>
            </svg>
          </div>

          <input
              class="auth__form-input"
              :type="passwordHideShow ? 'text':'password'"
              id="password"
              placeholder="Password"
              v-model="loginModel.password"
          />
          <p class="auth__form-error" v-if="errors && errors.length">
            {{ errors[0] }}
          </p>
        </Field>
      </div>
      <BaseButton
          :is-disabled="!!isLoading"
          :is-loading="!!isLoading"
          design="auth"
          type="submit"
          class-name="auth__form-button"
      >
        Tizimga kirish
      </BaseButton>
    </Form>
  </div>
</template>

<script setup>
import smart from "@/assets/img/png/smart.png";
import {Field, Form} from "vee-validate";
import {useAuth} from "@/composable/auth/auth";
import {ref} from "vue";
import BaseButton from "@/components/button/BaseButton";

const {login, loginModel, isLoading} = useAuth();
const phoneNumber = ref("(+998)-");

const rules = {
  password: "required|min:3|max:30",
  username: "required",
};

const submit = async () => {
  loginModel.username = "+" + phoneNumber.value.replace(/[^0-9]/g, "");
  await login();
};

const passwordHideShow = ref(false);
const togglePasswordEye = (value) => {
  passwordHideShow.value = !value
}

</script>

<style scoped lang="scss">
//  tel input style
.vue-tel-input {
  border: none;
  outline: none;

  div {
    border: 1.5px solid #c1c7cd;
    margin-right: 26px;
    border-radius: 3px;
  }

  &:focus-within {
    box-shadow: none;
    border-color: transparent;
  }

  .vti__input {
    padding: 12px 20px;
    border: 1.5px solid #c1c7cd;
    outline: none;
    border-radius: 3px;
    min-width: 350px;
  }
}
</style>
